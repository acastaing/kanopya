<config use_conf="test_conf" >
	<internalnetwork ip="10.0.0.0" mask="255.255.255.0" gateway="10.0.0.254"/>
	
	<conf label='mcs_conf' time_step='20' period='86400' rrd_base_dir='/tmp/monitor/base' graph_dir='/tmp/monitor/graph'>

		<!--
			Define graph to generate
		-->
		<generate_graph time_step='15'>
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='cpu' ds_label='rawIdleCPU,rawUserCPU,rawSystCPU' percent='yes' graph_type='stack'/>
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='mem' ds_label='memAvail' graph_type='stack'/>
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='net' ds_label='IpDataReceived,InputDiscarded' />
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='apache_stat' ds_label='ALL' />
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='apache_stat_reqsec' ds_label='ALL' />
			<graph targets='NODES,CLUSTERS' time_laps='1200,hour,day' set_label='apache_stat_workers' ds_label='ALL' />
			<graph targets='CLUSTERS' type='nodecount' time_laps='1200,hour,day' />		
		</generate_graph>
		
		<node_states starting_max_time="120" stopping_max_time="60"/>
		
		<set label='mem' ds_type='GAUGE' data_provider='SnmpProvider' max="memTotal" >
			<ds label="memTotal" oid='.1.3.6.1.4.1.2021.4.5.0' color='FFFF0055' comm="total ram"/>
			<!--ds label="memFree" oid='.1.3.6.1.4.1.2021.4.11.0' color='00FFFF55' comm="free ram + free swap"/-->
			<!--ds label="AvailableSwap" oid='.1.3.6.1.4.1.2021.4.4.0' color='FF00FF55' /-->
			<ds label="memAvail" oid='.1.3.6.1.4.1.2021.4.6.0' color='00FF0055' comm="free ram"/>
			<ds label="memBuffered" oid='.1.3.6.1.4.1.2021.4.14.0' color='0000FF55' />
			<ds label="memCached" oid='.1.3.6.1.4.1.2021.4.15.0' color='FF000055' />
			<!-- ds label="ramShared" oid='.1.3.6.1.4.1.2021.4.13.0' comm="Not implemented on some hosts" /-->
		</set>
		<set label='cpu' ds_type='COUNTER' data_provider='SnmpProvider' max="rawUserCPU+rawIdleCPU+rawWaitCPU+rawNiceCPU+rawSystCPU+rawKernelCPU+rawInterruptCPU" >
			<ds label='rawUserCPU' oid='.1.3.6.1.4.1.2021.11.50.0' color='FF000055'/>
			<ds label="rawIdleCPU" oid='.1.3.6.1.4.1.2021.11.53.0' color='00FFFF55' />
			<ds label="rawWaitCPU" oid='.1.3.6.1.4.1.2021.11.54.0' color='FF00FF55' />
			<ds label="rawNiceCPU" oid='.1.3.6.1.4.1.2021.11.51.0' color='FFFF0055' />
			<ds label="rawSystCPU" oid='.1.3.6.1.4.1.2021.11.52.0' color='00FF0055' comm="sometimes implemented as 'ssCpuRawWait(54)' + 'ssCpuRawKernel(55)'" />
			<ds label="rawKernelCPU" oid='.1.3.6.1.4.1.2021.11.55.0' color='0000FF55' />
			<ds label="rawInterruptCPU" oid='.1.3.6.1.4.1.2021.11.56.0' color='66666655' />
		</set>
	
		<set label='apache_stat' ds_type='GAUGE' max="" data_provider='ApacheProvider'>
			<!--<ds label='Total_Accesses' oid='Total Accesses' color='FF0000'/>
			<ds label="Total_kBytes" oid='Total kBytes' color='00FFFF' /> -->
			<ds label="CPULoad" oid='CPULoad' color='FF00FF' />
			<ds label="ReqPerSec" oid='ReqPerSec' color='FFFF00' />
			<ds label="BytesPerSec" oid='BytesPerSec' color='00FF00' />
			<ds label="BytesPerReq" oid='BytesPerReq' color='0000FF' />
		</set>
		
		<set label='apache_stat_workers' ds_type='GAUGE' max="" data_provider='ApacheProvider'>
			<ds label="IdleWorkers" oid='IdleWorkers' color='00FF00' />
			<ds label="BusyWorkers" oid='BusyWorkers' color='FF0000' />
		</set>
		
		<set label='apache_stat_reqsec' ds_type='COUNTER' max="" data_provider='ApacheProvider'>
			<ds label="ReqPer20Sec" oid='Total Accesses' color='00FF00' />
		</set>
		
		<set label='net' ds_type='COUNTER'>
			<!-- WARNING: this oid are row in snmp table (we take just the first ip version (or interface, need to check) il faut gérer ça!! -->
			<ds label="IpDataReceived" oid='.1.3.6.1.2.1.4.31.1.1.3.1' color='00FF00' />
			
			<ds label="IpDataReceived2" oid='.1.3.6.1.2.1.4.31.1.1.3.2' color='00FF00' />
			
			<!--ds label="IpOctetReceived" oid='.1.3.6.1.2.1.4.31.1.1.5.1' color='FF0000' /-->
			<ds label="InputDiscarded" oid='.1.3.6.1.2.1.4.31.1.1.17.1' color='0000FF' />
			<ds label="IpDataDelivred" oid='.1.3.6.1.2.1.4.31.1.1.18.1' color='00FFFF' />
			
			<ds label="IpDataOutRequest" oid='.1.3.6.1.2.1.4.31.1.1.20.1' color='FF00FF' />
			<!--ds label="IpOctetOutReqest" oid='.1.3.6.1.2.1.4.31.1.1.32.1' color='FFFF00' /-->
		</set>
		<!--set label='net2' ds_type='GAUGE'>
			<ds label="IpSpeed" oid='.1.3.6.1.2.1.2.2.1.5' color='FF00FF' />
		</set-->
	</conf>
	
	
	<conf label='test_conf' time_step='15' period='172800' rrd_base_dir='/tmp/monitor/base' graph_dir='/tmp/monitor/graph'>
				
		<node_states starting_max_time="120" stopping_max_time="60"/>
		
		<set label='cpu' ds_type='GAUGE' data_provider='VirtualProvider' max="" >
			<ds label="idle" oid='idleCPU' color='00FF0055' />
			<ds label="user" oid='userCPU' color='FF000055' />
			<ds label="syst" oid='systCPU' color='0000FF55' />
		</set>

		<set label='apache_status' ds_type='GAUGE' data_provider='VirtualProvider' max="" >
			<ds label="reqPerSec" oid='reqPerSec' color='FF0000' />
		</set>
		
		<!--
			Define graph to generate
		-->
		<generate_graph time_step='15'>
			<!--graph targets='NODES,CLUSTERS' time_laps='3600,hour,day' set_label='gen' ds_label='gen_var1,gen_var2' percent='yes'/-->
			<!--graph targets='NODES,CLUSTERS' time_laps='3600,hour,day' set_label='gen' ds_label='gen_var1,gen_var2,gen_var3' graph_type='stack' /-->
			<!--graph targets='NODES,CLUSTERS' time_laps='3600' set_label='cpu' ds_label='rawIdleCPU,rawUserCPU,rawSystCPU' percent='yes'/-->
			<graph targets='NODES,CLUSTERS' time_laps='1200' set_label='cpu' ds_label='ALL' percent='no' graph_type='stack'/>
			<graph targets='NODES,CLUSTERS' time_laps='1200' set_label='apache_status' ds_label='ALL'  />
			<graph targets='NODES,CLUSTERS' time_laps='1200' set_label='gen' ds_label='ALL'  />
			<graph targets='CLUSTERS' type='nodecount' time_laps='1200' />		
		</generate_graph>
				
	</conf>
	
</config>