<init_struct  nb="10">
  <general_conf
    kanopya_dir="/opt/kanopya"
     install_template_dir="/opt/kanopya/scripts/install/templates/"
     conf_dir="/opt/kanopya/conf/"
     comp_conf="/opt/kanopya/conf/components.conf"
     database_dir="/opt/kanopya/scripts/database/mysql/"
    comp_schemas_dir="/opt/kanopya/scripts/database/mysql/schemas/components/"
    schemas_dir="/opt/kanopya/scripts/database/mysql/schemas"
    data_dir="/opt/kanopya/scripts/database/mysql/data/"
    data_sql="/opt/kanopya/scripts/database/mysql/data/Data.sql"
    schema_sql="/opt/kanopya/scripts/database/mysql/schemas/Schemas.sql"
    apache_user="www-data"
  />
  <genfiles>
    <executor.conf template="executor.conf.tt">
      <datas logdir="log_directory" internal_net_add="internal_net_add" internal_net_mask="internal_net_mask" admin_password="dbpassword1"/>
    </executor.conf>
    <executor-log.conf template="executor-log.conf.tt">
        <datas logdir="log_directory"/>
    </executor-log.conf>
    <libkanopya.conf template="libkanopya.conf.tt">
        <datas db_user="dbuser" admin_password="dbpassword1" logdir="log_directory" internal_net_add="internal_net_add" internal_net_mask="internal_net_mask" dbport="dbport" dbip="dbip" dmz_net_add="dmz_net_add" dmz_net_mask="dmz_net_mask"/>
    </libkanopya.conf>
    <monitor.conf template="monitor.conf.tt">
        <datas admin_password="dbpassword1" internal_net_add="internal_net_add" internal_net_mask="internal_net_mask"/>
    </monitor.conf>
    <monitor-log.conf template="monitor-log.conf.tt">
        <datas logdir="log_directory"/>
    </monitor-log.conf>
    <orchestrator.conf template="orchestrator.conf.tt">
        <datas admin_password="dbpassword1"/>
    </orchestrator.conf>
    <orchestrator-log.conf template="orchestrator-log.conf.tt">
        <datas logdir="log_directory"/>
    </orchestrator-log.conf>
    <state-manager-log.conf template="state-manager-log.conf.tt">
        <datas logdir="log_directory"/>
    </state-manager-log.conf>

    <components.conf template="components.conf.tt">
        <datas />
    </components.conf>

    <webui-log.conf template="webui-log.conf.tt">
        <datas logdir="log_directory"/>
    </webui-log.conf>
  </genfiles>
  <questions>
    <!-- Database server conf -->
    <dbuser
       question="What is your Kanopya database user"
       default="kanopya"
       is_searchable="0"
       pattern="^\w+$"
       search_command=""/>
    <dbpassword1
       question="What is the password for kanopya user"
       default="K4n0pY4"
       is_searchable="0"
       is_secret="1"
       search_command=""/>
    <dbpassword2
       question="Please repeat Kanopya user's password"
       default="K4n0pY4"
       is_searchable="0"
       is_secret="1"
       search_command=""/>
    <dbip
       question="What is your database server ip or hostname"
       default="localhost"
       is_searchable="0"
       search_command=""/>
    <dbport
       question="What is your database server port"
       default="3306"
       is_searchable="0"
       search_command=""/>
    <!-- Kanopya server conf -->
    <kanopya_server_domain_name
       question="What is your Kanopya-server domain name"
       default=""
       is_searchable="1"
       search_command="domainname"
       pattern="^[a-z0-9-]+(\.[a-z0-9-]+)+$"/>
    <!-- Kanopya config-->
    <internal_net_interface
       question="Which Kanopya server network interface will be used to administrate infrastructure"
       default=""
       is_searchable="n"
       pattern="^\d+$"
       search_command="echo -n `ifconfig -a -s | awk 'NR!=1 { print $1 }'`"/>
    <internal_net_add
       question="What is the address of the network that will be used by node managed by Kanopya: this network will be booked for Kanopya!"
       default="10.0.0.0"
       is_searchable="0"
       search_command=""/>
    <internal_net_mask
       question="which mask is associated to this network"
       default="255.255.255.0"
       is_searchable="0"
       search_command=""/>
    <dmz_net_add
       question="What is the address of the network that will be used for infrastructure communication, this network will be booked for Kanopya!"
       default="10.1.0.0"
       is_searchable="0"
       search_command=""/>
    <dmz_net_mask
       question="which mask is associated to dmz network"
       default="255.255.255.0"
       is_searchable="0"
       search_command=""/>

    <log_directory
       question="Where will be stored Kanopya log"
       default="/var/log/kanopya/"
       is_searchable="0"
       search_command=""
       pattern="^.*\/$"/>
    <!-- Penser a checker avec plusieurs vg -->
    <vg
       question="Which volume group will be used by Kanopya"
       default=""
       is_searchable="n"
       search_command="echo -n `vgs  --noheadings -o vg_name --nosuffix --units M --rows`"
       pattern="^\d+$"/>
  </questions>
</init_struct>
